From 3f67b078efed968610ab52c92410ab20fe4b09a2 Mon Sep 17 00:00:00 2001
From: Andreas Kloeckner <inform@tiker.net>
Date: Tue, 20 Dec 2022 14:11:31 -0600
Subject: [PATCH 1/3] Update JIT targets (CUDA 12 deprecations, plus additions)
 (closes gh-402)

---
 src/wrapper/wrap_cudadrv.cpp | 29 +++++++++++++++++++++++++++--
 1 file changed, 27 insertions(+), 2 deletions(-)

diff --git a/src/wrapper/wrap_cudadrv.cpp b/src/wrapper/wrap_cudadrv.cpp
index 01f0918..5912bf4 100644
--- a/src/wrapper/wrap_cudadrv.cpp
+++ b/src/wrapper/wrap_cudadrv.cpp
@@ -1030,11 +1030,36 @@ BOOST_PYTHON_MODULE(_driver)
     .value("COMPUTE_12", CU_TARGET_COMPUTE_12)
     .value("COMPUTE_13", CU_TARGET_COMPUTE_13)
 #endif
-#if CUDAPP_CUDA_VERSION >= 3000
+#if (CUDAPP_CUDA_VERSION >= 3000) && CUDAPP_CUDA_VERSION < 12000
     .value("COMPUTE_20", CU_TARGET_COMPUTE_20)
 #endif
-#if CUDAPP_CUDA_VERSION >= 3020
+#if (CUDAPP_CUDA_VERSION >= 3020) && CUDAPP_CUDA_VERSION < 12000
     .value("COMPUTE_21", CU_TARGET_COMPUTE_21)
+#endif
+#if (CUDAPP_CUDA_VERSION >= 11000)
+    .value("COMPUTE_30", CU_TARGET_COMPUTE_30)
+    .value("COMPUTE_32", CU_TARGET_COMPUTE_32)
+    .value("COMPUTE_35", CU_TARGET_COMPUTE_35)
+    .value("COMPUTE_37", CU_TARGET_COMPUTE_37)
+
+    .value("COMPUTE_50", CU_TARGET_COMPUTE_50)
+    .value("COMPUTE_52", CU_TARGET_COMPUTE_52)
+    .value("COMPUTE_53", CU_TARGET_COMPUTE_53)
+
+    .value("COMPUTE_60", CU_TARGET_COMPUTE_60)
+    .value("COMPUTE_61", CU_TARGET_COMPUTE_61)
+    .value("COMPUTE_62", CU_TARGET_COMPUTE_62)
+
+    .value("COMPUTE_70", CU_TARGET_COMPUTE_70)
+    .value("COMPUTE_72", CU_TARGET_COMPUTE_72)
+    .value("COMPUTE_75", CU_TARGET_COMPUTE_75)
+
+    .value("COMPUTE_80", CU_TARGET_COMPUTE_80)
+    .value("COMPUTE_86", CU_TARGET_COMPUTE_86)
+#endif
+#if (CUDAPP_CUDA_VERSION >= 12000)
+    .value("COMPUTE_90", CU_TARGET_COMPUTE_90)
+    .value("COMPUTE_90A", CU_TARGET_COMPUTE_90A)
 #endif
     ;
 
-- 
GitLab


From f426d48298db387739e7b275a7b2a069eebfeda4 Mon Sep 17 00:00:00 2001
From: Andreas Kloeckner <inform@tiker.net>
Date: Tue, 20 Dec 2022 14:42:15 -0600
Subject: [PATCH 3/3] Drop np.int from curandom for numpy deprecation

---
 pycuda/curandom.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/pycuda/curandom.py b/pycuda/curandom.py
index fe6f54b..160776a 100644
--- a/pycuda/curandom.py
+++ b/pycuda/curandom.py
@@ -581,7 +581,7 @@ class _RandomNumberGeneratorBase:
             func = self.generators["uniform_float"]
         elif data.dtype == np.float64:
             func = self.generators["uniform_double"]
-        elif data.dtype in [np.int, np.int32, np.uint32]:
+        elif data.dtype in [np.int32, np.uint32]:
             func = self.generators["uniform_int"]
         elif data.dtype in [np.int64, np.uint64] and self.generator_bits >= 64:
             func = self.generators["uniform_long"]
-- 
GitLab

